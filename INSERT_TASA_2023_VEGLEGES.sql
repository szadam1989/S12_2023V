--grant PP_SELECT to bud07679;
set serveroutput on;
exec ksh_role_pc.list_users ('PP_SELECT');

select owner, table_name, comments FROM ALL_TAB_COMMENTS where owner like 'PR23' order by table_name;

select count(*) from PR23.PR_P01_V23_A24_V_V01;
select count(*) from PR23.PR_P08A_V23_A24_V_V01;
select count(*) from PR23.PR_P11T_V23_A24_V_V01;
select count(*) from PR23.PR_P29EIFRS_V23_A24_V_V01;
select count(*) from PR23.PR_P29_V23_A24_V_V01;
select count(*) from PR23.PR_P29EUD_V23_A24_V_V01;
select count(*) from PR23.PR_P29IFRS_V23_A24_V_V01;
select count(*) from PR23.PR_P71ATE_V23_A24_V_V01;
select count(*) from PR23.PR_PKIVA_V23_A24_V_V01;
select count(*) from PR23.PR_PKATA_V23_A24_V_V01;--2023. adatévtõl kezdõdõen már nincs ez a tábla

select * from PP23.PP23_W_HIT_T order by M003; --1-es, 2-es és 3-as sémák

select * from PP23.PP23_FISIM_PSZAF_V02_T order by M003; --4-es séma

select * from PP23.PP23_W_PENZT_MNYP_T order by M003;  --5-ös séma

select * from PP23.PP23_W_PENZT_ONK_T order by M003; --6-os séma

select * from PP23.PP23_W_PENZT_EGESZ_T order by M003; --7-es és 8-as sémák

select * from PP23.PP23_W_TASA_2371_V02_T order by M003; --10-es séma

select * from PP23.PP23_KETTOSOK_R01_V02_T order by M003; --11.1-es séma

select * from PP23.PP23_KETTOSOK_R00_V02_T  order by M003; --11.2-es, 11.3-as, 11.4-es és 11.5-ös sémák

select * from PP23.PP23_BIZT_V02_T order by M003; --12, 13, 14, 15 és 16 sémák

select * from PP23.PP23_BIZT_FIOK_TASA_V02_T order by M003; --17-es séma

select * from PP23.PP23_W_PENZT_FOGL_T order by M003; --19-es séma

select * from PP23.PP23_SCV_TASA_V02_T order by M003; --50-es és 51-es sémák

select * from PP23.PP23_KATA_V02_T order by M003; --52-es séma volt, amely a 2023. adatévtõl kezdõdõen már nem létezik

select * from PP23.PP23_KIVA_V02_T order by M003; --53-as séma

--create table PP23.CEGLISTA_VEGLEGES as select M003, M0581 from PP23.CEGLISTA_ELOZETES;
--truncate table PP23.CEGLISTA_VEGLEGES;
grant select on PP23.CEGLISTA_VEGLEGES TO PP_SELECT;
grant insert, delete, update on PP23.CEGLISTA_VEGLEGES TO PP_UPDATE;
select * from PP23.CEGLISTA_VEGLEGES;--8520


--create table PP23.CEGLISTA_SCV_VEGLEGES as select M003, M0581 from PP23.CEGLISTA_SCV_ELOZETES;
--truncate table PP23.CEGLISTA_SCV_VEGLEGES;
grant select on PP23.CEGLISTA_SCV_VEGLEGES TO PP_SELECT;
grant insert, delete, update on PP23.CEGLISTA_SCV_VEGLEGES TO PP_UPDATE;
select * from PP23.CEGLISTA_SCV_VEGLEGES;--254


select * from PP23.CEGLISTA_VEGLEGES where M003 = '10949638';--0 Eximbankot törölni kell, amennyiben rajta van
select * from PP23.CEGLISTA_SCV_VEGLEGES where M003 = '10949638';
--delete from PP23.CEGLISTA_VEGLEGES where M003 = '10949638';
--commit;


-- elsõ körben szükséges a CEGLISTA és az SCV lista közötti eltéréseket megszüntetni:
select SIMA.M003, SCV.M003 from PP23.CEGLISTA_VEGLEGES SIMA, PP23.CEGLISTA_SCV_VEGLEGES SCV where SIMA.M003 = SCV.M003;
--0 törzsszám lesz törölve a nem SCV-bõl

--delete from PP23.CEGLISTA_VEGLEGES where M003 in (select SIMA.M003 from PP23.CEGLISTA_VEGLEGES SIMA, PP23.CEGLISTA_SCV_VEGLEGES SCV where SIMA.M003 = SCV.M003);


--Ezután ellenõrizni kell, hogy egy törzsszám csak egyszer szerepeljen
select M003, count(M003) from PP23.CEGLISTA_VEGLEGES group by M003 having count(M003) > 1 order by M003;
--0 törzsszám duplán szerepel

select M003, M0581 from PP23.CEGLISTA_VEGLEGES where M003 in (select M003 from PP23.CEGLISTA_VEGLEGES group by M003 having count(M003) > 1) order by M003, M0581;--0
select distinct M003, M0581 from PP23.CEGLISTA_VEGLEGES where M003 in (select M003 from PP23.CEGLISTA_VEGLEGES group by M003 having count(M003) > 1) order by M003, M0581;--0

--delete from PP23.CEGLISTA_VEGLEGES where M003 in (select distinct M003 from PP23.CEGLISTA_VEGLEGES where M003 in (select M003 from PP23.CEGLISTA_VEGLEGES group by M003 having count(M003) > 1));--292 sor törölve
commit;



select M003, count(M003) from PP23.CEGLISTA_SCV_VEGLEGES group by M003 having count(M003) > 1;
--0 törzsszám duplán szerepel

select M003, M0581 from PP23.CEGLISTA_SCV_VEGLEGES where M003 in (select M003 from PP23.CEGLISTA_SCV_VEGLEGES group by M003 having count(M003) > 1) order by M003, M0581;--292
--delete from PP23.CEGLISTA_SCV_VEGLEGES where M003 = '28767219';
--INSERT INTO PP23.CEGLISTA_SCV_VEGLEGES(M003, M0581) VALUES('28767219', '6420');
--commit;



--create table PP23.PP23_W_TASA_2301_V02_T as select * from PP23.PP23_W_TASA_2301_V01_T;
--truncate table PP23.PP23_W_TASA_2301_V02_T;
grant select on PP23.PP23_W_TASA_2301_V02_T TO PP_SELECT;
grant insert, delete, update on PP23.PP23_W_TASA_2301_V02_T TO PP_UPDATE;
select * from PP23.PP23_W_TASA_2301_V02_T;

--01 TÁSA
select count(*) from PP23.PP23_W_TASA_2301_V02_T; --üres vagy nem, ha nem akkor törölni kell
--1826

select SIMA.M003, SIMA.M0581, ROUND(PR01.PRJA013), ROUND(PR01.PRJA050), ROUND(PR01.PRJA258), ROUND(PR01.PRJA260), ROUND(PR01.PRJA261) 
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P01_V23_A24_V_V01 PR01 where SIMA.M003 = PR01.M003;
--1826

insert into PP23.PP23_W_TASA_2301_V02_T (M003, M0581, PRJA013, PRJA050, PRJA258, PRJA260, PRJA261)
select SIMA.M003, SIMA.M0581, ROUND(PR01.PRJA013), ROUND(PR01.PRJA050), ROUND(PR01.PRJA258), ROUND(PR01.PRJA260), ROUND(PR01.PRJA261) 
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P01_V23_A24_V_V01 PR01 where SIMA.M003 = PR01.M003;

commit;


--create table PP23.PP23_W_TASA_2308_V02_T as select * from PP23.PP23_W_TASA_2308_V01_T;
--truncate table PP23.PP23_W_TASA_2308_V02_T;
grant select on PP23.PP23_W_TASA_2308_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_W_TASA_2308_V02_T TO PP_UPDATE;
select * from PP23.PP23_W_TASA_2308_V02_T where M003 = '12226483';


--08 TÁSA 
select count(*) from PP23.PP23_W_TASA_2308_V02_T; --üres vagy nem, ha nem akkor törölni kell
--7167, 7201

select SIMA.M003, SIMA.M0581, PRJA045, PRJA087, PRJA088, PRJA131, PRJA196, PRJA224, 
--PRJA264,-- PRJA229,-- PRJA230, 
PRJA237, PRJA247, PRJA248, PRJA254, PRJA251, PRJA252, PRJA253, PRJA270, PRJA255, 
PRJA256, PRJA178, PRJA179, PRJA180, PRJA184, PRJA275, PRJA277, 
PRJA278, PRJA279, PRJA280, PRJA281, PRJA282, PRJA285, PRJA286, 
PRJA287, PRJA288, PRJA289,-- PRJA291,-- PRJA292,-- PRJA293, --PRJA294,
PRJA272, PRJA333, PRJA334--, PRJA061
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P08A_V23_A24_V_V01 PR08 
where SIMA.M003 = PR08.M003;
--7167
--7201


select * from PR23.PR_P08A_V23_A24_V_V01;


insert into PP23.PP23_W_TASA_2308_V02_T(M003, M0581, PRJA045, 
PRJA087, PRJA088, PRJA131, PRJA196,
PRJA224, 
--PRJA264,-- PRJA229,-- PRJA230, 
PRJA237,
PRJA247, PRJA248, 
PRJA254, PRJA251, PRJA252, PRJA253, PRJA270,  
PRJA255, PRJA256, 
PRJA178, PRJA179, PRJA180, PRJA184, PRJA275, 
PRJA277, PRJA278, PRJA279, PRJA280, PRJA281, PRJA282, 
PRJA285, PRJA286, PRJA287, PRJA288, PRJA289,-- PRJA291,-- PRJA292,-- PRJA293, --PRJA294,
PRJA272, PRJA333, PRJA334--, PRJA061
)
select SIMA.M003, SIMA.M0581, PRJA045, 
PRJA087, PRJA088, PRJA131, PRJA196,
PRJA224, 
--PRJA264,-- PRJA229,-- PRJA230, 
PRJA237,
PRJA247, PRJA248, 
PRJA254, PRJA251, PRJA252, PRJA253, PRJA270,  
PRJA255, PRJA256, 
PRJA178, PRJA179, PRJA180, PRJA184, PRJA275, 
PRJA277, PRJA278, PRJA279, PRJA280, PRJA281, PRJA282, 
PRJA285, PRJA286, PRJA287, PRJA288, PRJA289,-- PRJA291,-- PRJA292,-- PRJA293, --PRJA294,
PRJA272, PRJA333, PRJA334--, PRJA061
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P08A_V23_A24_V_V01 PR08 
where SIMA.M003 = PR08.M003;


commit;




--create table PP23.PP23_SCV_TASA_V02_T as select * from PP23.PP23_SCV_TASA_V01_T;
--truncate table PP23.PP23_SCV_TASA_V02_T;
grant select on PP23.PP23_SCV_TASA_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_SCV_TASA_V02_T TO PP_UPDATE;

--SCV TÁSA cégek beszúrása 01 és 08 TÁSA-ból
select count(*) from PP23.PP23_SCV_TASA_V02_T; --üres vagy nem, ha nem akkor törölni kell
--157 = 157
select * from PP23.PP23_SCV_TASA_V02_T;

select distinct '2023', M003, M0581 from PP23.CEGLISTA_SCV_VEGLEGES where M003 in (
select SCV.M003 from PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV.M003 = PR01.M003
UNION
select SCV.M003 FROM PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P08A_V23_A24_V_V01 PR08 
where SCV.M003 = PR08.M003);
--157
--134

select * from PR23.PR_P01_V23_A24_V_V01;

insert into PP23.PP23_SCV_TASA_V02_T(MEV, M003, M0581)
select distinct '2023', M003, M0581 from PP23.CEGLISTA_SCV_VEGLEGES where M003 in (
select SCV.M003 from PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV.M003 = PR01.M003
UNION
select SCV.M003 FROM PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P08A_V23_A24_V_V01 PR08 
where SCV.M003 = PR08.M003);

commit;

--SCV TÁSA adatok betöltése 01 TÁSA-ból

set serveroutput on;
declare
    sql_statement VARCHAR2(1000);
    TYPE t_torzsszam IS TABLE OF VARCHAR2(8);
    v_torzsszam t_torzsszam;
begin
	sql_statement := 'select M003 from PP23.PP23_SCV_TASA_V02_T';
	execute immediate sql_statement bulk collect into v_torzsszam;

	for a in v_torzsszam.first..v_torzsszam.last loop
    
        dbms_output.put_line(v_torzsszam(a));
		execute immediate'
		update PP23.PP23_SCV_TASA_V02_T
		set PRJA013 = (select PR01.PRJA013 from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV_TASA.M003 = PR01.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRJA050 = (SELECT PR01.PRJA050 from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV_TASA.M003 = PR01.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRJA258 = (SELECT PR01.PRJA258 from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV_TASA.M003 = PR01.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRJA261 = (SELECT PR01.PRJA261 from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV_TASA.M003 = PR01.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRJA260 = (SELECT PR01.PRJA260 from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P01_V23_A24_V_V01 PR01 where SCV_TASA.M003 = PR01.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||''')
		WHERE M003 = '''|| v_torzsszam(a) ||'''
		'
		;

	end loop;
end;
/

commit;


--SCV TÁSA adatok betöltése 08 TÁSA-ból
set serveroutput on;
declare
    sql_statement VARCHAR2(1000);
    TYPE t_torzsszam IS TABLE OF VARCHAR2(8);
    v_torzsszam t_torzsszam;
begin
	sql_statement := 'select M003 from PP23.PP23_SCV_TASA_V02_T';
	execute immediate sql_statement bulk collect into v_torzsszam;

	for a in v_torzsszam.first..v_torzsszam.last loop
    
        dbms_output.put_line(v_torzsszam(a));
		execute immediate'
		update PP23.PP23_SCV_TASA_V02_T
		set PRJA045 = (select sum(PR08.PRJA045) from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P08A_V23_A24_V_V01 PR08 
        where SCV_TASA.M003 = PR08.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),			
        PRJA087 = (select sum(PR08.PRJA087) from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P08A_V23_A24_V_V01 PR08 
        where SCV_TASA.M003 = PR08.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),	
        PRJA088 = (select sum(PR08.PRJA088) from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P08A_V23_A24_V_V01 PR08 
        where SCV_TASA.M003 = PR08.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||'''),
        PRJA196 = (select sum(PR08.PRJA196) from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PR23.PR_P08A_V23_A24_V_V01 PR08 
        where SCV_TASA.M003 = PR08.M003 and SCV_TASA.M003 = '''|| v_torzsszam(a) ||''')
		WHERE M003 = '''|| v_torzsszam(a) ||'''
		'
		; 

	end loop;
end;
/

commit;
--PRJA061 eltûnt

select * from PP23.PP23_SCV_TASA_V02_T;



--11 TÁSA
--create table PP23.PP23_W_TASA_2311_V02_T as select * from PP23.PP23_W_TASA_2311_V01_T;
--truncate table PP23.PP23_W_TASA_2311_V02_T;

--grant select on PP23.PP23_W_TASA_2311_V02_T TO PP_SELECT;
--grant insert, update, delete on PP23.PP23_W_TASA_2311_V02_T TO PP_UPDATE;


--select count(*) from PP23.PP23_W_TASA_2311_V02_T; --üres vagy nem, ha nem akkor törölni kell
--select * from PP23.PP23_W_TASA_2311_V02_T;

select * from PR23.PR_P11T_V23_A24_V_V01 where M003 in (select M003 from PP23.CEGLISTA_VEGLEGES); 
select * from PR23.PR_P11T_V23_A24_V_V01 where M003 in (select M003 from PP23.CEGLISTA_SCV_VEGLEGES);
--Egy cég kivételesen szerepel benne: 10949638, amely az Eximbank volt
--A PR21.PR_P11T_V21_A22_V_V01 tábla M003 értékei nem szerepelnek a PP23.CEGLISTA_VEGLEGES táblában.

/*insert into PP23.PP23_W_TASA_2311_V02_T (M003, M0581, PRJA056, PRJA212, PRJA313, PRJA314)
select SIMA.M003, SIMA.M0581, PR11.PRJA056, PR11.PRJA212, PR11.PRJA313, PR11.PRJA314
from PP23.CEGLISTA_VEGLEGES SIMA, PR21.PR_P11T_V21_A22_V_V01 PR11 
where SIMA.M003 = PR11.M003;*/

--drop table PP23.PP23_W_TASA_2311_V01_T;
commit;




--43 TÁSA 2020. adatévtõl kezdõdõen már nincs
--select count(*) from PP23.PP23_W_TASA_2343_V02_T;
--0

/*select SIMA.M003, SIMA.M0581, PRCA108 EAG001, PRCA121 EAG002, PRCA122, PRDA024, PRCA122 EAG017, PRJA121, PRCA108, PRJA106, PRAA078
from PP23.CEGLISTA_VEGLEGES SIMA, PR20.W_V_P2043_V01 PR43
where SIMA.M003 = PR43.M003;*/
--0

/*insert into PP23.PP23_W_TASA_2343_V02_T	(M003, M0581, EAG001, EAG002, PRCA122, PRDA024, EAG017, PRJA121, PRCA108, PRJA106, PRAA078)
select SIMA.M003, SIMA.M0581, PRCA108 EAG001, PRCA121 EAG002, PRCA122, PRDA024, PRCA122 EAG017, PRJA121, PRCA108, PRJA106, PRAA078
from PP23.CEGLISTA_VEGLEGES SIMA, PR20.W_V_P2043_V01 PR43
where SIMA.M003 = PR43.M003;

commit;*/


--create table PP23.PP23_W_TASA_2371_V02_T as select * from PP23.PP23_W_TASA_2371_V01_T;
--truncate table PP23.PP23_W_TASA_2371_V02_T;
grant select on PP23.PP23_W_TASA_2371_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_W_TASA_2371_V02_T TO PP_UPDATE;


--71 TÁSA
select count(*) from PP23.PP23_W_TASA_2371_V02_T;
--98


SELECT SIMA.M003,  SIMA.M0581, PRAA002, PRAA008, PRAA035, PRBA013, PRBA015, PRBA021, PRBA028, 
PRCA004, PRCA007, PRCA037, PRCA053, PRCA054, PRCA103, PRDA024, PRDA076, PRDA088, PRJA122, PRAA019, PRAA026, PRAA041, PRAA045, 
PRAA049, PRBA002, PRBA030,  PRBA050, PRBA051, PRCA003, 
PRCA015, PRCA019, PRCA020, PRCA027, PRCA031, PRCA044, 
PRCA045, PRCA055, 
PRCA176, PRCA177, PRJA222
FROM PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P71ATE_V23_A24_V_V01 PR71 
where SIMA.M003 = PR71.M003;
--98


insert into PP23.PP23_W_TASA_2371_V02_T(M003, M0581, PRAA002, PRAA008, PRAA035, PRBA013, PRBA015, PRBA021, PRBA028,
PRCA004, PRCA007, PRCA037, PRCA053, PRCA054, PRCA103, PRDA024, PRDA076, PRDA088, PRJA122, PRAA019, PRAA026, PRAA041, PRAA045, 
PRAA049, PRBA002, PRBA030, PRBA050, PRBA051, PRCA003, 
PRCA015, PRCA019, PRCA020, PRCA027, PRCA031, PRCA044, 
PRCA045, PRCA055, 
PRCA176, PRCA177, PRJA222) 
SELECT SIMA.M003, SIMA.M0581, PRAA002, PRAA008, PRAA035, PRBA013, PRBA015, PRBA021, PRBA028, 
PRCA004, PRCA007, PRCA037, PRCA053, PRCA054, PRCA103, PRDA024, PRDA076, PRDA088, PRJA122, PRAA019, PRAA026, PRAA041, PRAA045, 
PRAA049, PRBA002, PRBA030, PRBA050, PRBA051, PRCA003, 
PRCA015, PRCA019, PRCA020, PRCA027, PRCA031, PRCA044, 
PRCA045, PRCA055, 
PRCA176, PRCA177, PRJA222
FROM PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P71ATE_V23_A24_V_V01 PR71 
where SIMA.M003 = PR71.M003;

commit;


--KATA (52-es) séma már nincs 2023. adatév óta, de az EAR miatt létrehozandó
create table PP23.PP23_KATA_V02_T as select * from PP23.PP23_KATA_V01_T;
--truncate table PP23.PP23_KATA_V02_T;
grant select on PP23.PP23_KATA_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_KATA_V02_T TO PP_UPDATE;
select * from PP23.PP23_KATA_V02_T;

--KATA tábla
--select count(*) from PP23.PP23_KATA_V02_T; --A tábla üres-e?
--775

/*select SIMA.M003, SIMA.M0581, M0491, PRCA103, PRCA152, PRJA215--M005, M045, M065, PRCA054,
from PR23.PR_PKATA_V23_A24_V_V01 KATA, PP23.CEGLISTA_VEGLEGES SIMA
where SIMA.M003 = KATA.M003;*/
--585

/*insert into PP23.PP23_KATA_V02_T(M003, M0581, M0491, PRCA103, PRCA152, PRJA215) --M005, M045, M065, PRCA054
select SIMA.M003, SIMA.M0581, M0491, PRCA103, PRCA152, PRJA215 --M005, M045, M065, PRCA054,
from PR23.PR_PKATA_V23_A24_V_V01 KATA, PP23.CEGLISTA_VEGLEGES SIMA
where SIMA.M003 = KATA.M003;

commit;*/

--create table PP23.PP23_KIVA_V02_T as select * from PP23.PP23_KIVA_V01_T;
--truncate table PP23.PP23_KIVA_V02_T;
grant select on PP23.PP23_KIVA_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_KIVA_V02_T TO PP_UPDATE;


--KIVA tábla
select count(*) from PP23.PP23_KIVA_V02_T; --A tábla üres-e?
--1248


--M005, M045 eltûntek
select SIMA.M003, SIMA.M0581, M0491, PRCA016, PRJA216, PRJA217, PRCA035, PRCA057, PRCA054, PRDA112, PRJA122, PRJA257, PRCA189, PRCA182--, PRCA155
from PR23.PR_PKIVA_V23_A24_V_V01 KIVA, PP23.CEGLISTA_VEGLEGES SIMA
where SIMA.M003 = KIVA.M003;
--1248

--M005, M045 eltûntek
insert into PP23.PP23_KIVA_V02_T(M003, M0581, M0491, PRCA016, PRJA216, PRJA217, PRCA035, PRCA057, PRCA054, PRDA112, PRJA122, PRJA257, PRCA189, PRCA182) --PRCA155,
select SIMA.M003, SIMA.M0581,                 M0491, PRCA016, PRJA216, PRJA217, PRCA035, PRCA057, PRCA054, PRDA112, PRJA122, PRJA257, PRCA189, PRCA182 --PRCA155,
from PR23.PR_PKIVA_V23_A24_V_V01 KIVA, PP23.CEGLISTA_VEGLEGES SIMA
where SIMA.M003 = KIVA.M003;

commit;


--create table PP23.PP23_KATA_KIVA_V02_T as select * from PP23.PP23_KATA_KIVA_V01_T;
--truncate table PP23.PP23_KATA_KIVA_V02_T;
--grant select on PP23.PP23_KATA_KIVA_V02_T TO PP_SELECT;
--grant insert, update, delete on PP23.PP23_KATA_KIVA_V02_T TO PP_UPDATE;


--KATA_KIVA tábla
--select count(*) from PP23.PP23_KATA_KIVA_V02_T; --A tábla üres-e?
--1833

/*SELECT M003, M0581, 1 as "KATA_KIVA" FROM PP23.PP23_KATA_V02_T
UNION 
SELECT M003, M0581, 0 as "KATA_KIVA" FROM PP23.PP23_KIVA_V02_T;*/
--1833

/*insert into PP23.PP23_KATA_KIVA_V02_T(M003, M0581, KATA_KIVA)
(SELECT M003, M0581, 1 as "KATA_KIVA" FROM PP23.PP23_KATA_V02_T
UNION 
SELECT M003, M0581, 0 as "KATA_KIVA" FROM PP23.PP23_KIVA_V02_T);

commit;*/

--create table PP23.PP23_SCV_AFA_V02_T as select * from PP23.PP23_SCV_AFA_V01_T;
--truncate table PP23.PP23_SCV_AFA_V02_T;
select * from PP23.PP23_SCV_AFA_V02_T;--150

grant select on PP23.PP23_SCV_AFA_V02_T TO PP_SELECT;
grant insert, update, delete on PP23.PP23_SCV_AFA_V02_T TO PP_UPDATE;

--SCV ÁFA adatok
select count(*) from PP23.PP23_SCV_AFA_V02_T;
--202

select count(*) from PC23.PCF_AFA_YF_23_V00; --A tábla üres-e?

select '2023', M003, PCFB031, PCFB040, PCFB066, PCFB070, PCFB036, (PCFB031 + PCFB040 + PCFB066 + PCFB070 + PCFB036) as osszeg 
from (select max(M003) as M003, sum(nvl(PCFB031, 0)) as PCFB031, sum(nvl(PCFB040, 0)) as PCFB040, sum(nvl(PCFB066, 0)) as PCFB066,
sum(nvl(PCFB070, 0)) as PCFB070, sum(nvl(PCFB036, 0)) AS PCFB036
from PC23.PCF_AFA_YF_23_V00 GROUP BY M003) 
where M003 in (select M003 from PP23.CEGLISTA_SCV_VEGLEGES) or M003 in (select M003 from PP23.CEGLISTA_VEGLEGES where MP551 = '51');
--202 véglegesre

select M003 from PP23.CEGLISTA_VEGLEGES where MP551 = '51';--68
		
insert into PP23.PP23_SCV_AFA_V02_T(MEV, M003, PCFB031, PCFB040, PCFB066, PCFB070, PCFB036, osszeg)
select '2023', M003, PCFB031, PCFB040, PCFB066, PCFB070, PCFB036, (PCFB031 + PCFB040 + PCFB066 + PCFB070 + PCFB036) as osszeg 
from (select max(M003) as M003, sum(nvl(PCFB031, 0)) as PCFB031, sum(nvl(PCFB040, 0)) as PCFB040, sum(nvl(PCFB066, 0)) as PCFB066,
sum(nvl(PCFB070, 0)) as PCFB070, sum(nvl(PCFB036, 0)) AS PCFB036
from PC23.PCF_AFA_YF_23_V00 GROUP BY M003) 
where M003 in (select M003 from PP23.CEGLISTA_SCV_VEGLEGES) or M003 in (select M003 from PP23.CEGLISTA_VEGLEGES where MP551 = '51');	

commit;

select MEV, M003, PCFB031, PCFB040, PCFB066, PCFB070, PCFB036, osszeg from PP23.PP23_SCV_AFA_V02_T
minus
select '2023', M003, PCFB031, PCFB040, PCFB066, PCFB070, PCFB036, (PCFB031 + PCFB040 + PCFB066 + PCFB070 + PCFB036) as osszeg 
from (select max(M003) as M003, sum(nvl(PCFB031, 0)) as PCFB031, sum(nvl(PCFB040, 0)) as PCFB040, sum(nvl(PCFB066, 0)) as PCFB066,
sum(nvl(PCFB070, 0)) as PCFB070, sum(nvl(PCFB036, 0)) AS PCFB036
from PC23.PCF_AFA_YF_23_V00 GROUP BY M003) 
where M003 in (select M003 from PP23.CEGLISTA_SCV_VEGLEGES);


--create table PP23.PP23_W_TASA_2329_V02_T as select * from PP23.PP23_W_TASA_2329_V01_T;
--truncate table PP23.PP23_W_TASA_2329_V02_T;
grant select on PP23.PP23_W_TASA_2329_V02_T TO PP_SELECT;
grant insert, delete, update on PP23.PP23_W_TASA_2329_V02_T TO PP_UPDATE;

select count(*) from PP23.PP23_W_TASA_2329_V02_T;
--4759 = 4759

--PR29.M005, PR29.M045, eltûntek
SELECT SIMA.M003, SIMA.M0581, 2022, nvl(PRAA068,0) + nvl(PRAA069,0), nvl(PRCA149,0) + nvl(PRCA078,0), nvl(PRDA109,0) + nvl(PRDA110,0), nvl(PRDA024,0) - nvl(PRDA079,0), 
PRAA002, PRAA008, PRAA009, PRAA014, PRAA019, PRAA026, PRAA035, PRAA036, PRAA038, PRAA041, PRAA045, PRAA048, PRAA049, PRAA063, PRAA066, PRAA067, PRAA068, PRAA069, 
PRBA002, PRBA006, PRBA012, PRBA013, PRBA015, PRBA021, PRBA022, PRBA028, PRBA030, PRBA035, PRBA037, PRBA038, PRBA039, PRBA040, PRBA044, PRBA048, PRBA049, PRBA050, 
PRBA051, PRBA053, PRBA054, PRBA055, PRBA056, 
PRCA002, PRCA004, PRCA007, PRCA008, PRCA015, PRCA017, PRCA019, PRCA020, PRCA022, PRCA023, PRCA024, PRCA027, PRCA029, PRCA031, PRCA035, PRCA037, PRCA044, PRCA045, 
PRCA046, PRCA053, PRCA054, PRCA057, PRCA075, PRCA077, PRCA078, PRCA081, PRCA090, PRCA091, PRCA092, PRCA093, PRCA094, PRCA095, PRCA096, PRCA103, 
PRCA126, 
PRCA127, 
PRCA133, PRCA134, PRCA135, PRCA136, PRCA137, PRCA138, PRCA140, PRCA141, PRCA144, PRCA149, PRCA150, PRCA151, 
PRDA006, PRDA012, PRDA024, PRDA032, PRDA041, PRDA049, PRDA065, PRDA066, PRDA068, PRDA072, PRDA073, PRDA076, PRDA079, PRDA080, PRDA082, nvl(PRDA107, 0) + nvl(PRDA108, 0), PRDA085, PRDA088, 
PRDA092, PRDA093, PRDA095, PRDA098, PRDA107, PRDA108, PRDA109, PRDA110, PRAA001, PRAA013, PRAA064, PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, 
PRCA038, PRCA055, PRCA073, PRCA156, PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, 
PRDA050, PRDA067, PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118, PRDA121, 
PRJA122, PRJA222
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29_V23_A24_V_V01 PR29
where sima.M003 = PR29.M003;
--4759


insert into PP23.PP23_W_TASA_2329_V02_T(M003, M0581, MEV, PFA0M013, PFC0M038, PFD0M050, PFD0M106, 
PRAA002, PRAA008, PRAA009, PRAA014, PRAA019, PRAA026, PRAA035, PRAA036, PRAA038, PRAA041, PRAA045, PRAA048, PRAA049, PRAA063, PRAA066, PRAA067, PRAA068, PRAA069, 
PRBA002, PRBA006, PRBA012, PRBA013, PRBA015, PRBA021, PRBA022, PRBA028, PRBA030, PRBA035, PRBA037, PRBA038, PRBA039, PRBA040, PRBA044, PRBA048, PRBA049, PRBA050, 
PRBA051, PRBA053, PRBA054, PRBA055, PRBA056, 
PRCA002, PRCA004, PRCA007, PRCA008, PRCA015, PRCA017, PRCA019, PRCA020, PRCA022, PRCA023, PRCA024, PRCA027, PRCA029, PRCA031, PRCA035, PRCA037, PRCA044, PRCA045, 
PRCA046, PRCA053, PRCA054, PRCA057, PRCA075, PRCA077, PRCA078, PRCA081, PRCA090, PRCA091, PRCA092, PRCA093, PRCA094, PRCA095, PRCA096, PRCA103,  
PRCA126, 
PRCA127, 
PRCA133, PRCA134, PRCA135, PRCA136, PRCA137, PRCA138, PRCA140, PRCA141, PRCA144, PRCA149, PRCA150, PRCA151, 
PRDA006, PRDA012, PRDA024, PRDA032, PRDA041, PRDA049, PRDA065, PRDA066, PRDA068, PRDA072, PRDA073, PRDA076, PRDA079, PRDA080, PRDA082, PRDA084, PRDA085, PRDA088, 
PRDA092, PRDA093, PRDA095, PRDA098, PRDA107, PRDA108, PRDA109, PRDA110, PRAA001, PRAA013, PRAA064, PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, 
PRCA038, PRCA055, PRCA073, PRCA156, PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, 
PRDA050, PRDA067, PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118, PRDA121, 
PRJA122, PRJA222)
SELECT SIMA.M003, SIMA.M0581, 2023, nvl(PRAA068,0) + nvl(PRAA069,0), nvl(PRCA149,0) + nvl(PRCA078,0), nvl(PRDA109,0) + nvl(PRDA110,0), nvl(PRDA024,0) - nvl(PRDA079,0), 
PRAA002, PRAA008, PRAA009, PRAA014, PRAA019, PRAA026, PRAA035, PRAA036, PRAA038, PRAA041, PRAA045, PRAA048, PRAA049, PRAA063, PRAA066, PRAA067, PRAA068, PRAA069, 
PRBA002, PRBA006, PRBA012, PRBA013, PRBA015, PRBA021, PRBA022, PRBA028, PRBA030, PRBA035, PRBA037, PRBA038, PRBA039, PRBA040, PRBA044, PRBA048, PRBA049, PRBA050, 
PRBA051, PRBA053, PRBA054, PRBA055, PRBA056, 
PRCA002, PRCA004, PRCA007, PRCA008, PRCA015, PRCA017, PRCA019, PRCA020, PRCA022, PRCA023, PRCA024, PRCA027, PRCA029, PRCA031, PRCA035, PRCA037, PRCA044, PRCA045, 
PRCA046, PRCA053, PRCA054, PRCA057, PRCA075, PRCA077, PRCA078, PRCA081, PRCA090, PRCA091, PRCA092, PRCA093, PRCA094, PRCA095, PRCA096, PRCA103,
PRCA126, 
PRCA127, 
PRCA133, PRCA134, PRCA135, PRCA136, PRCA137, PRCA138, PRCA140, PRCA141, PRCA144, PRCA149, PRCA150, PRCA151, 
PRDA006, PRDA012, PRDA024, PRDA032, PRDA041, PRDA049, PRDA065, PRDA066, PRDA068, PRDA072, PRDA073, PRDA076, PRDA079, PRDA080, PRDA082, nvl(PRDA107, 0) + nvl(PRDA108, 0), PRDA085, PRDA088, 
PRDA092, PRDA093, PRDA095, PRDA098, PRDA107, PRDA108, PRDA109, PRDA110, PRAA001, PRAA013, PRAA064, PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, 
PRCA038, PRCA055, PRCA073, PRCA156, PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, 
PRDA050, PRDA067, PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118, PRDA121, 
PRJA122, PRJA222
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29_V23_A24_V_V01 PR29
where sima.M003 = PR29.M003;
--4759
commit;



insert into PP23.PP23_W_TASA_2329_V02_T(M003, M0581, MEV, PFA0M013, PFC0M038, PFD0M050, PFD0M106, 
PRAA002, PRAA008, PRAA009, PRAA014, PRAA019, PRAA026, PRAA035, PRAA036, PRAA038, PRAA041, PRAA045, PRAA048, PRAA049, PRAA063, PRAA066, PRAA067, PRAA068, PRAA069, 
PRBA002, PRBA006, PRBA012, PRBA013, PRBA015, PRBA021, PRBA022, PRBA028, PRBA030, PRBA035, PRBA037, PRBA038, PRBA039, PRBA040, PRBA044, PRBA048, PRBA049, PRBA050, 
PRBA051, PRBA053, PRBA054, PRBA055, PRBA056, 
PRCA002, PRCA004, PRCA007, PRCA008, PRCA015, PRCA017, PRCA019, PRCA020, PRCA022, PRCA023, PRCA024, PRCA027, PRCA029, PRCA031, PRCA035, PRCA037, PRCA044, PRCA045, 
PRCA046, PRCA053, PRCA054, PRCA057, PRCA075, PRCA077, PRCA078, PRCA081, PRCA090, PRCA091, PRCA092, PRCA093, PRCA094, PRCA095, PRCA096, PRCA103,  
PRCA126, 
PRCA127, 
PRCA133, PRCA134, PRCA135, PRCA136, PRCA137, PRCA138, PRCA140, PRCA141, PRCA144, PRCA149, PRCA150, PRCA151, 
PRDA006, PRDA012, PRDA024, PRDA032, PRDA041, PRDA049, PRDA065, PRDA066, PRDA068, PRDA072, PRDA073, PRDA076, PRDA079, PRDA080, PRDA082, PRDA084, PRDA085, PRDA088, 
PRDA092, PRDA093, PRDA095, PRDA098, PRDA107, PRDA108, PRDA109, PRDA110, PRAA001, PRAA013, PRAA064, PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, 
PRCA038, PRCA055, PRCA073, PRCA156, PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, 
PRDA050, PRDA067, PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118, PRDA121, 
PRJA122, PRJA222)
SELECT SIMA.M003, SIMA.M0581, 2023, nvl(PRAA068,0) + nvl(PRAA069,0), nvl(PRCA149,0) + nvl(PRCA078,0), nvl(PRDA109,0) + nvl(PRDA110,0), nvl(PRDA024,0) - nvl(PRDA079,0), 
PRAA002, PRAA008, PRAA009, PRAA014, PRAA019, PRAA026, PRAA035, PRAA036, PRAA038, PRAA041, PRAA045, PRAA048, PRAA049, PRAA063, PRAA066, PRAA067, PRAA068, PRAA069, 
PRBA002, PRBA006, PRBA012, PRBA013, PRBA015, PRBA021, PRBA022, PRBA028, PRBA030, PRBA035, PRBA037, PRBA038, PRBA039, PRBA040, PRBA044, PRBA048, PRBA049, PRBA050, 
PRBA051, PRBA053, PRBA054, PRBA055, PRBA056, 
PRCA002, PRCA004, PRCA007, PRCA008, PRCA015, PRCA017, PRCA019, PRCA020, PRCA022, PRCA023, PRCA024, PRCA027, PRCA029, PRCA031, PRCA035, PRCA037, PRCA044, PRCA045, 
PRCA046, PRCA053, PRCA054, PRCA057, PRCA075, PRCA077, PRCA078, PRCA081, PRCA090, PRCA091, PRCA092, PRCA093, PRCA094, PRCA095, PRCA096, PRCA103,
PRCA126, 
PRCA127, 
PRCA133, PRCA134, PRCA135, PRCA136, PRCA137, PRCA138, PRCA140, PRCA141, PRCA144, PRCA149, PRCA150, PRCA151, 
PRDA006, PRDA012, PRDA024, PRDA032, PRDA041, PRDA049, PRDA065, PRDA066, PRDA068, PRDA072, PRDA073, PRDA076, PRDA079, PRDA080, PRDA082, nvl(PRDA107, 0) + nvl(PRDA108, 0), PRDA085, PRDA088, 
PRDA092, PRDA093, PRDA095, PRDA098, PRDA107, PRDA108, PRDA109, PRDA110, PRAA001, PRAA013, PRAA064, PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, 
PRCA038, PRCA055, PRCA073, PRCA156, PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, 
PRDA050, PRDA067, PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118, PRDA121, 
PRJA122, PRJA222
from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29_V23_A24_V_V01 PR29
where sima.M003 = PR29.M003;
--55
commit;



select count(*) from PP23.PP23_W_TASA_2329_V02_T;--4759 + 55 = 4814




select		cc.M003, '', '', cc.M0581, '2023', 
            tt.PRCA157, tt.PRCA167,	tt.PRCA002,	tt.PRCA168,	tt.PRJA298,	tt.PRCA169,	tt.PRCA170,	tt.PRCA171,	tt.PRCA008,	tt.PRCA092,	
            tt.PRCA172, tt.PRCA022,	tt.PRCA023,	tt.PRCA024,	tt.PRCA173,	tt.PRCA019,	tt.PRCA016,	tt.PRCA017,	tt.PRCA094, tt.PRCA020,	
            tt.PRCA095,	
            tt.PRJA299,	tt.PRCA091,	tt.PRJA300,	tt.PRCA035,	tt.PRCA175,	tt.PRCA178,	tt.PRCA179,	tt.PRCA180,	tt.PRCA181,	
            tt.PRCA174,	tt.PRAA002,	tt.PRAA070,	tt.PRAA071,	tt.PRAA072,	tt.PRAA073,	tt.PRAA026,	tt.PRAA036,	tt.PRAA074,	tt.PRAA075,	
            tt.PRAA045,	tt.PRAA076,	tt.PRAA077,	tt.PRBA002,	tt.PRBA037,	tt.PRBA038,	tt.PRBA039,	tt.PRBA040,	tt.PRBA054,	tt.PRBA006,	
            tt.PRBA055,	tt.PRBA056,	tt.PRBA013,	tt.PRBA015,	
            tt.PRBA059,	tt.PRBA060,	tt.PRBA021,	tt.PRBA022,	tt.PRBA051,	tt.PRBA057,	
            tt.PRBA028,	tt.PRBA030,	tt.PRDA076,	tt.PRBA050,	tt.PRBA058,	tt.PRAA049,	tt.PRDA024,	tt.PRDA079,	tt.PRCA057,
			tt.PRAA067,	tt.PRJA301
			from PP23.CEGLISTA_VEGLEGES cc, PR23.PR_P29IFRS_V23_A24_V_V01 tt 
			where tt.M003 = cc.M003 and cc.M003 not in (select M003 from PP23.PP23_W_TASA_2329_V02_T);
            --39

select * from PP23.PP23_W_TASA_2329_V02_T where M003 in ('10788086', '12321942', 
'10198014', '12899986', '26666600', '10326556', '12250604', '22574361', '12951659', 
'24719018', '10433748', '12248074', '12217595', '12238972', '24928395', '13491196', 
'22353605', '11879978', '25978221', '12402502', '14413591', '22196796', '22310981', 
'10189377', '24800880', '10873151', '27807903', '27961104', '10011922', '12853812', 
'23183034', '27943555', '24982582', '10644371', '10782028', '10920394', '12201923', 
'14153730', '26304218')
order by M003;
--39

select * from PR23.PR_P29IFRS_V23_A24_V_V01 where M003 in (select M003 from PP23.CEGLISTA_VEGLEGES);--52 cég áttöltendõ lenne


insert into PP23.PP23_W_TASA_2329_V02_T
			(M003, M005, M045, M0581, mev, 
            PRCA157, PRCA167,	PRCA002,	PRCA168,	PRJA298,	PRCA169,	PRCA170,	PRCA171,	PRCA008,	PRCA092,	
            PRCA172, PRCA022,	PRCA023,	PRCA024,	PRCA173,	PRCA019,	PRCA016,	PRCA017,	PRCA094,	PRCA020,	
            PRCA095, 
            PRJA299,	PRCA091,	PRJA300,	PRCA035,	PRCA175,	PRCA178,	PRCA179,	PRCA180,	PRCA181,	
            PRCA174, PRAA002,	PRAA070,	PRAA071,	PRAA072,	PRAA073,	PRAA026,	PRAA036,	PRAA074,	PRAA075,	
            PRAA045, PRAA076,	PRAA077,	PRBA002,	PRBA037,	PRBA038,	PRBA039,	PRBA040,	PRBA054,	PRBA006,	
            PRBA055, PRBA056,	PRBA013,	PRBA015,	
            PRBA059,	PRBA060,	PRBA021,	PRBA022,	PRBA051,	PRBA057,	
            PRBA028, PRBA030,	PRDA076,	PRBA050,	PRBA058,	PRAA049,	PRDA024,	PRDA079,	PRCA057,		
			PRAA067, PRJA301)
select		cc.M003, '', '', cc.M0581, '2023', 
            tt.PRCA157, tt.PRCA167,	tt.PRCA002,	tt.PRCA168,	tt.PRJA298,	tt.PRCA169,	tt.PRCA170,	tt.PRCA171,	tt.PRCA008,	tt.PRCA092,	
            tt.PRCA172, tt.PRCA022,	tt.PRCA023,	tt.PRCA024,	tt.PRCA173,	tt.PRCA019,	tt.PRCA016,	tt.PRCA017,	tt.PRCA094, tt.PRCA020,	
            tt.PRCA095,	
            tt.PRJA299,	tt.PRCA091,	tt.PRJA300,	tt.PRCA035,	tt.PRCA175,	tt.PRCA178,	tt.PRCA179,	tt.PRCA180,	tt.PRCA181,	
            tt.PRCA174,	tt.PRAA002,	tt.PRAA070,	tt.PRAA071,	tt.PRAA072,	tt.PRAA073,	tt.PRAA026,	tt.PRAA036,	tt.PRAA074,	tt.PRAA075,	
            tt.PRAA045,	tt.PRAA076,	tt.PRAA077,	tt.PRBA002,	tt.PRBA037,	tt.PRBA038,	tt.PRBA039,	tt.PRBA040,	tt.PRBA054,	tt.PRBA006,	
            tt.PRBA055,	tt.PRBA056,	tt.PRBA013,	tt.PRBA015,	
            tt.PRBA059,	tt.PRBA060,	tt.PRBA021,	tt.PRBA022,	tt.PRBA051,	tt.PRBA057,	
            tt.PRBA028,	tt.PRBA030,	tt.PRDA076,	tt.PRBA050,	tt.PRBA058,	tt.PRAA049,	tt.PRDA024,	tt.PRDA079,	tt.PRCA057,		
			tt.PRAA067,	tt.PRJA301
			from PP23.CEGLISTA_VEGLEGES cc, PR23.PR_P29IFRS_V23_A24_V_V01 tt 
			where tt.M003 = cc.M003 and cc.M003 not in (select M003 from PP23.PP23_W_TASA_2329_V02_T);
--39 sor beszúrva még
commit;


 
--29 TÁSA IFRS
set serveroutput on;
declare
    sql_statement VARCHAR2(1000);
    TYPE t_torzsszam IS TABLE OF VARCHAR2(8);
    v_torzsszam t_torzsszam;
begin

	sql_statement := 'SELECT SIMA.M003 FROM PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS 
	where SIMA.M003 = PR29IFRS.M003';
    --TOR helyett már M003 van
	execute immediate sql_statement BULK COLLECT INTO v_torzsszam;
    
	for a in v_torzsszam.first..v_torzsszam.last loop
    
        dbms_output.put_line(v_torzsszam(a));
		execute immediate'
		update PP23.PP23_W_TASA_2329_V02_T
		SET PRCA157 = (select PR29IFRS.PRCA157 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRCA167 = (SELECT PR29IFRS.PRCA167 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA002 = (SELECT PR29IFRS.PRCA002 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA168 = (SELECT PR29IFRS.PRCA168 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRJA298 = (SELECT PR29IFRS.PRJA298 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),			
		PRCA169 = (SELECT PR29IFRS.PRCA169 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA170 = (SELECT PR29IFRS.PRCA170 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA171 = (SELECT PR29IFRS.PRCA171 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA008 = (SELECT PR29IFRS.PRCA008 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA092 = (SELECT PR29IFRS.PRCA092 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA172 = (SELECT PR29IFRS.PRCA172 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA022 = (SELECT PR29IFRS.PRCA022 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA023 = (SELECT PR29IFRS.PRCA023 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA024 = (SELECT PR29IFRS.PRCA024 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA173 = (SELECT PR29IFRS.PRCA173 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA019 = (SELECT PR29IFRS.PRCA019 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA016 = (SELECT PR29IFRS.PRCA016 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA017 = (SELECT PR29IFRS.PRCA017 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA094 = (SELECT PR29IFRS.PRCA094 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA020 = (SELECT PR29IFRS.PRCA020 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
        PRCA095 = (SELECT PR29IFRS.PRCA095 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRJA299 = (SELECT PR29IFRS.PRJA299 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA091 = (SELECT PR29IFRS.PRCA091 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRJA300 = (SELECT PR29IFRS.PRJA300 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA035 = (SELECT PR29IFRS.PRCA035 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA175 = (SELECT PR29IFRS.PRCA175 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA178 = (SELECT PR29IFRS.PRCA178 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRCA179 = (SELECT PR29IFRS.PRCA179 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA180 = (SELECT PR29IFRS.PRCA180 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRCA181 = (SELECT PR29IFRS.PRCA181 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),				
		PRCA174 = (SELECT PR29IFRS.PRCA174 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRAA002 = (SELECT PR29IFRS.PRAA002 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA070 = (SELECT PR29IFRS.PRAA070 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA071 = (SELECT PR29IFRS.PRAA071 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRAA072 = (SELECT PR29IFRS.PRAA072 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA073 = (SELECT PR29IFRS.PRAA073 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA026 = (SELECT PR29IFRS.PRAA026 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRAA036 = (SELECT PR29IFRS.PRAA036 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),			
		PRAA074 = (SELECT PR29IFRS.PRAA074 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA075 = (SELECT PR29IFRS.PRAA075 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA045 = (SELECT PR29IFRS.PRAA045 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRAA076 = (SELECT PR29IFRS.PRAA076 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA077 = (SELECT PR29IFRS.PRAA077 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA002 = (SELECT PR29IFRS.PRBA002 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA037 = (SELECT PR29IFRS.PRBA037 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA038 = (SELECT PR29IFRS.PRBA038 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA039 = (SELECT PR29IFRS.PRBA039 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA040 = (SELECT PR29IFRS.PRBA040 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA054 = (SELECT PR29IFRS.PRBA054 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA006 = (SELECT PR29IFRS.PRBA006 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRBA055 = (SELECT PR29IFRS.PRBA055 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA056 = (SELECT PR29IFRS.PRBA056 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA013 = (SELECT PR29IFRS.PRBA013 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA015 = (SELECT PR29IFRS.PRBA015 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),			
		PRBA059 = (SELECT PR29IFRS.PRBA059 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA060 = (SELECT PR29IFRS.PRBA060 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA021 = (SELECT PR29IFRS.PRBA021 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA022 = (SELECT PR29IFRS.PRBA022 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA051 = (SELECT PR29IFRS.PRBA051 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA057 = (SELECT PR29IFRS.PRBA057 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA028 = (SELECT PR29IFRS.PRBA028 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA030 = (SELECT PR29IFRS.PRBA030 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRDA076 = (SELECT PR29IFRS.PRDA076 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA050 = (SELECT PR29IFRS.PRBA050 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRBA058 = (SELECT PR29IFRS.PRBA058 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRAA049 = (SELECT PR29IFRS.PRAA049 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRDA024 = (SELECT PR29IFRS.PRDA024 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRDA079 = (SELECT PR29IFRS.PRDA079 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRCA057 = (SELECT PR29IFRS.PRCA057 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),		
		PRAA067 = (SELECT PR29IFRS.PRAA067 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||'''),	
		PRJA301 = (SELECT PR29IFRS.PRJA301 from PP23.CEGLISTA_VEGLEGES SIMA, PR23.PR_P29IFRS_V23_A24_V_V01 PR29IFRS where SIMA.M003 = PR29IFRS.M003 and SIMA.M003 = '''|| v_torzsszam(a) ||''')
		WHERE M003 = '''|| v_torzsszam(a) ||'''
		'
		;

	end loop;

end;
/

commit;

SELECT a.M003, a.PRCA054, b.PRCA054 FROM PP23.PP23_W_TASA_2329_V02_T a
INNER JOIN PP23.PP23_W_TASA_2329_V01_T b
on a.M003 = b.M003
where a.PRCA054 is null;
--v_2329_ins_up csak véglegesre
--92 db törzsszám esetén lehetne frissíteni a PRCA054-es mutatót az elõzetes tábla alapján, de mind NULL értekû


SELECT a.M003, a.PRCA054, b.PRCA054 FROM PP23.PP23_W_TASA_2329_V02_T a
INNER JOIN PP23.PP23_W_TASA_2329_V01_T b
on a.M003 = b.M003
where a.PRCA054 is null and b.PRCA054 is not null;
--92 db törzsszám közül 0 esetén lehet frissíteni a PRCA054-es mutatót az elõzetes tábla alapján

SELECT a.M003, a.PRCA054, b.PRCA054 FROM PP23.PP23_W_TASA_2329_V02_T a
INNER JOIN PP23.PP23_W_TASA_2329_V01_T b
on a.M003 = b.M003
where a.PRCA054 = b.PRCA054;
--4169 cégnél megegyeznek


set serveroutput on;
declare
sql_statement VARCHAR2(1000);
TYPE t_teaor IS TABLE OF VARCHAR2(20);
v_teaor t_teaor;
begin
	sql_statement := 'SELECT a.M003 FROM PP23.PP23_W_TASA_2329_V02_T a
	INNER JOIN PP23.PP23_W_TASA_2329_V01_T b
	ON a.M003 = b.M003
	WHERE a.PRCA054 IS NULL
	';

	EXECUTE IMMEDIATE sql_statement BULK COLLECT INTO v_teaor;
    
    dbms_output.put_line(v_teaor.FIRST);
    dbms_output.put_line(v_teaor.LAST);


	FOR a IN v_teaor.FIRST..v_teaor.LAST LOOP
        DBMS_OUTPUT.PUT_LINE(a);
        DBMS_OUTPUT.PUT_LINE(v_teaor(a));
		EXECUTE IMMEDIATE'
		UPDATE PP23.PP23_W_TASA_2329_V02_T
		SET PRCA054 = 
		(SELECT PRCA054
		FROM PP23.PP23_W_TASA_2329_V01_T
		WHERE m003 = '''|| v_teaor(a) ||''')
		WHERE m003 = '''|| v_teaor(a) ||'''
		';

	END LOOP;
end;
/

commit;

--create table PP23.PP23_W_TASA_2329_SCV_V02_T as select * from PP23.PP23_W_TASA_2329_SCV_V01_T;
--truncate table PP23.PP23_W_TASA_2329_SCV_V02_T;
grant select on PP23.PP23_W_TASA_2329_SCV_V02_T TO PP_SELECT;
grant insert, delete, update on PP23.PP23_W_TASA_2329_SCV_V02_T TO PP_UPDATE;


--29 TÁSA_SCV
select count(*) from PP23.PP23_W_TASA_2329_SCV_V02_T;
--217

select 2022, SCV.M003, SCV.M0581, PRCA053, PRCA075, 
PRDA088, PRCA054, PRDA093, PRDA065, PRDA095, PRDA066, PRDA098, PRCA029, PRDA085, PRDA068, PRDA092, 
PRCA077, PRCA103, PRCA002, PRCA007, PRCA004, PRDA072, PRCA015, PRCA008, PRCA090, PRCA091, PRCA092, 
PRCA093, PRCA022, PRCA023, PRCA019, PRCA017, PRCA094, PRCA020, PRCA027, PRDA073, PRDA032, PRCA095, 
PRCA144, PRCA031, PRCA037, PRCA035, PRCA096, PRCA150, PRCA151, PRCA081, PRCA044, PRCA126, PRCA149, 
PRCA078, PRCA127, PRCA045, PRCA046, nvl(PRCA149, 0) + nvl(PRCA078, 0) + nvl(PRCA078, 0), 
PRAA002, PRAA008, PRAA019, PRAA026, PRAA035, PRAA036, PRAA041, PRAA045, PRAA048, PRBA002, PRBA037, 
PRBA038, PRBA039, PRBA040, PRBA054, PRBA006, PRBA055, PRBA056, praa038, PRBA012, PRBA013, PRBA048, 
PRBA044, PRBA053, PRBA015, PRBA049, PRBA021, PRBA022, PRBA051, PRBA028, PRBA030, PRDA076, PRBA050, 
PRBA035, PRAA049, PRDA006, PRDA012, PRDA107, PRDA108, PRAA066, PRAA009, PRAA068, PRAA069, PRAA014, 
PRDA041, PRDA049, PRDA109, PRDA110, PRDA082, PRDA080, nvl(PRAA068, 0) + nvl(PRAA069, 0), nvl(PRDA107, 0) + nvl(PRDA108, 0), nvl(PRDA109, 0) + nvl(PRDA110, 0), 
PRDA024, PRDA079, PRCA024, PRCA057, PRAA063, PRAA067,  
nvl(prda024, 0) - nvl(prda079, 0), 
PRCA133, PRCA135, PRCA137, PRCA140, PRCA134, PRCA136, PRCA138, PRCA141, PRAA001, PRAA013, PRAA064, 
PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, PRCA038, PRCA055, PRCA073, PRCA156, 
PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, PRDA050, PRDA067, 
PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118,
PRDA121, PRJA122, PRJA222
from PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P29_V23_A24_V_V01 PR29 
where SCV.M003 = PR29.M003;
--217

insert into PP23.PP23_W_TASA_2329_SCV_V02_T(MEV, M003, M0581,  PRCA053, PRCA075, 
PRDA088, PRCA054, PRDA093, PRDA065, PRDA095, PRDA066, PRDA098, PRCA029, PRDA085, PRDA068, PRDA092, 
PRCA077, PRCA103, PRCA002, PRCA007, PRCA004, PRDA072, PRCA015, PRCA008, PRCA090, PRCA091, PRCA092, 
PRCA093, PRCA022, PRCA023, PRCA019, PRCA017, PRCA094, PRCA020, PRCA027, PRDA073, PRDA032, PRCA095, 
PRCA144, PRCA031, PRCA037, PRCA035, PRCA096, PRCA150, PRCA151, PRCA081, PRCA044, PRCA126, PRCA149, 
PRCA078, PRCA127, PRCA045, PRCA046, PFC0M038, 
PRAA002, PRAA008, PRAA019, PRAA026, PRAA035, PRAA036, PRAA041, PRAA045, PRAA048, PRBA002, PRBA037, 
PRBA038, PRBA039, PRBA040, PRBA054, PRBA006, PRBA055, PRBA056, PRAA038, PRBA012, PRBA013, PRBA048, 
PRBA044, PRBA053, PRBA015, PRBA049, PRBA021, PRBA022, PRBA051, PRBA028, PRBA030, prda076, PRBA050, 
PRBA035, PRAA049, PRDA006, PRDA012, PRDA107, PRDA108, PRAA066, PRAA009, PRAA068, PRAA069, PRAA014, 
PRDA041, PRDA049, PRDA109, PRDA110, PRDA082, PRDA080, PFA0M013, PRDA084, PFD0M050, 
PRDA024, PRDA079, PRCA024, PRCA057, PRAA063, PRAA067, 
PFD0M106, 
PRCA133, PRCA135, PRCA137, PRCA140, PRCA134, PRCA136, PRCA138, PRCA141, PRAA001, PRAA013, PRAA064, 
PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, PRCA038, PRCA055, PRCA073, PRCA156, 
PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, PRDA050, PRDA067, 
PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118,
PRDA121, PRJA122, PRJA222)
select 2023, SCV.M003, SCV.M0581, PRCA053, PRCA075, 
PRDA088, PRCA054, PRDA093, PRDA065, PRDA095, PRDA066, PRDA098, PRCA029, PRDA085, PRDA068, PRDA092, 
PRCA077, PRCA103, PRCA002, PRCA007, PRCA004, PRDA072, PRCA015, PRCA008, PRCA090, PRCA091, PRCA092, 
PRCA093, PRCA022, PRCA023, PRCA019, PRCA017, PRCA094, PRCA020, PRCA027, PRDA073, PRDA032, PRCA095, 
PRCA144, PRCA031, PRCA037, PRCA035, PRCA096, PRCA150, PRCA151, PRCA081, PRCA044, PRCA126, PRCA149, 
PRCA078, PRCA127, PRCA045, PRCA046, nvl(PRCA149, 0) + nvl(PRCA078, 0) + nvl(PRCA078, 0), 
PRAA002, PRAA008, PRAA019, PRAA026, PRAA035, PRAA036, PRAA041, PRAA045, PRAA048, PRBA002, PRBA037, 
PRBA038, PRBA039, PRBA040, PRBA054, PRBA006, PRBA055, PRBA056, praa038, PRBA012, PRBA013, PRBA048, 
PRBA044, PRBA053, PRBA015, PRBA049, PRBA021, PRBA022, PRBA051, PRBA028, PRBA030, PRDA076, PRBA050, 
PRBA035, PRAA049, PRDA006, PRDA012, PRDA107, PRDA108, PRAA066, PRAA009, PRAA068, PRAA069, PRAA014, 
PRDA041, PRDA049, PRDA109, PRDA110, PRDA082, PRDA080, nvl(PRAA068, 0) + nvl(PRAA069, 0), nvl(PRDA107, 0) + nvl(PRDA108, 0), nvl(PRDA109, 0) + nvl(PRDA110, 0), 
PRDA024, PRDA079, PRCA024, PRCA057, PRAA063, PRAA067,
nvl(prda024, 0) - nvl(prda079, 0), 
PRCA133, PRCA135, PRCA137, PRCA140, PRCA134, PRCA136, PRCA138, PRCA141, PRAA001, PRAA013, PRAA064, 
PRBA001, PRBA016, PRBA036, PRCA001, PRCA003, PRCA016, PRCA032, PRCA038, PRCA055, PRCA073, PRCA156, 
PRCA158, PRCA159, PRCA160, PRCA161, PRCA162, PRCA163, PRCA164, PRCA165, PRCA166, PRDA050, PRDA067, 
PRDA090, PRDA091, PRDA096, PRDA097, PRDA106, PRDA111, PRDA114, PRDA115, PRDA116, PRDA117, PRDA118,
PRDA121, PRJA122, PRJA222
from PP23.CEGLISTA_SCV_VEGLEGES SCV, PR23.PR_P29_V23_A24_V_V01 PR29 
where SCV.M003 = PR29.M003;

commit;



select SCV_TASA.M003, SCV_TASA.PRCA016, SCV.PRCA016, SCV_TASA.PRDA084, SCV.PRDA084 
from PP23.PP23_SCV_TASA_V02_T SCV_TASA, PP23.PP23_W_TASA_2329_SCV_V02_T SCV 
where SCV_TASA.M003 = SCV.M003 order by SCV.M003;
--v_scv_upd_scv
--A legvégén is célszerû lefuttatni, úgyis csak frissít.
set serveroutput on;
declare
    sql_statement VARCHAR2(1000);
    TYPE t_torzsszam IS TABLE OF VARCHAR2(8);
    v_torzsszam t_torzsszam;
begin
	sql_statement := 'select t.M003 from PP23.PP23_SCV_TASA_V02_T T
	LEFT JOIN PP23.PP23_W_TASA_2329_SCV_V02_T tt ON tt.M003 = T.M003';
	execute immediate sql_statement bulk collect into v_torzsszam;
    
	FOR a IN v_torzsszam.FIRST..v_torzsszam.LAST LOOP
        
        DBMS_OUTPUT.PUT_LINE(v_torzsszam(a));
		execute immediate'
		UPDATE PP23.PP23_SCV_TASA_V02_T
		SET PRCA008 = (select PP_29SCV.PRCA008 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA090 = (select PP_29SCV.PRCA090 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA022 = (select PP_29SCV.PRCA022 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA023 = (select PP_29SCV.PRCA023 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA093 = (select PP_29SCV.PRCA093 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA016 = (select PP_29SCV.PRCA016 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),--Pótoltam
        PRCA017 = (select PP_29SCV.PRCA017 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA094 = (select PP_29SCV.PRCA094 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA081 = (select PP_29SCV.PRCA081 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA150 = (select PP_29SCV.PRCA150 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA151 = (select PP_29SCV.PRCA151 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA078 = (select PP_29SCV.PRCA078 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA149 = (select PP_29SCV.PRCA149 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA054 = (select PP_29SCV.PRCA054 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA024 = (select PP_29SCV.PRCA024 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRDA066 = (select PP_29SCV.PRDA066 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRDA068 = (select PP_29SCV.PRDA068 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA004 = (select PP_29SCV.PRCA004 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA007 = (select PP_29SCV.PRCA007 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA020 = (select PP_29SCV.PRCA020 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA091 = (select PP_29SCV.PRCA091 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA092 = (select PP_29SCV.PRCA092 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRCA103 = (select PP_29SCV.PRCA103 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
		PRDA082 = (select PP_29SCV.PRDA082 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||'''),
        PRDA084 = (select PP_29SCV.PRDA084 from PP23.PP23_SCV_TASA_V02_T PP23_SCVTASA, PP23.PP23_W_TASA_2329_SCV_V02_T PP_29SCV where PP23_SCVTASA.M003 = PP_29SCV.M003 and PP23_SCVTASA.M003 = '''|| v_torzsszam(a) ||''')--Pótoltam
		WHERE M003 = '''|| v_torzsszam(a) ||'''
		'
		;

	END LOOP;

END;
/

commit;



--ÁFA adatok beszúrása
select MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082 from PP23.PP23_W_TASA_2329_SCV_V02_T
where M003 in (select M003 from PP23.PP23_SCV_AFA_V02_T where M003 not in (select M003 from PP23.PP23_SCV_TASA_V02_T))
order by M003;
--68 cég kerül áttöltésre a PP23.PP23_SCV_TASA_V02_T adatbázis táblába
--81 cég kerül áttöltésre a PP23.PP23_SCV_TASA_V02_T adatbázis táblába

select * from PP23.PP23_SCV_AFA_V02_T where M003 in ('10886311', 
'11920524', '12235508', '12282294', '12963021', '12963241', '12963296', 
'13398763', '13650045', '13749808', '13932514', '13979593', '14009064', 
'14014855', '14036563', '14142871', '14158632', '14517602', '14649969', 
'23292637', '24296074', '24326937', '24766223', '25198319', '25300606', 
'25334212', '25390559', '25397484', '25558098', '25828865', '25905919', 
'25955464', '25984714', '26087016', '26094469', '26149387', '26196743', 
'26196798', '26220095', '26241829', '26253631', '26388506', '26395746', 
'26558675', '26590659', '26614593', '26707848', '26712598', '26719069', 
'27028504', '27049857', '27063024', '27279827', '27282104', '27421282', 
'27521519', '27522194', '27522503', '27717479', '27786464', '27805413', 
'27876273', '27971402', '27993354', '28743509', '28830982', '28831000', '29201389') 
order by M003;
--68


select * from PP23.PP23_SCV_AFA_V02_T where M003 in ('10886311', '11858807', '11920524', 
'12071623', '12235508', '12282294', '12415157', '12963021', '12963241', '12963296', 
'13398763', '13650045', '13749808', '13932514', '13954318', '13954394', '13979593', 
'14009064', '14014855', '14036563', '14142871', '14158632', '14350755', '14517602', 
'14649969', '23292637', '24296074', '24326937', '24383842', '24766223', '25081330', 
'25123562', '25198319', '25300606', '25334212', '25390559', '25397484', '25557932', 
'25558098', '25563281', '25828865', '25905919', '25955464', '25984714', '26087016', 
'26094469', '26149387', '26196743', '26196798', '26220095', '26241829', '26253631', 
'26388506', '26395746', '26558675', '26590659', '26614593', '26707848', '26712598', 
'26719069', '27028504', '27049857', '27063024', '27279827', '27282104', '27288856', 
'27421282', '27521519', '27522194', '27522503', '27717479', '27773747', '27786464', 
'27805413', '27876273', '27971402', '27993354', '28743509', '28830982', '28831000', '29201389')
order by M003;
--81

insert into PP23.PP23_SCV_TASA_V02_T(MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082)
select MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082 from PP23.PP23_W_TASA_2329_SCV_V02_T
where M003 in (select M003 from PP23.PP23_SCV_AFA_V02_T where M003 not in (select M003 from PP23.PP23_SCV_TASA_V02_T));
--81

commit;

select MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082 from PP23.PP23_W_TASA_2329_SCV_V02_T where M003 not in (select M003 from PP23.PP23_SCV_TASA_V02_T)
order by M003;
--0

select * from PP23.PP23_W_TASA_2329_SCV_V02_T where M003 in ('11690519', 
'12528857', '12565427', '12565496', '12580138', '12942084', '12962965', 
'13712309', '13867942', '14200856', '14650048', '22993122', '23069217', 
'23540277', '24822756', '24873271', '24917278', '25110508', '25359961', 
'25389951', '25880665', '26391890', '26592493', '26604855', '26608048', 
'26643049', '26647036', '26658878', '26661540', '26673376', '26707381', 
'27064771', '27065978', '27118502', '27198535', '27199749', '27283136', 
'27285224', '27398948', '27514111', '27943892', '29301221') 
order by M003;
--42


select * from PP23.PP23_W_TASA_2329_SCV_V02_T where M003 in ('11690519', 
'12528857', '12565427', '12565496', '12580138', '12942084', '12962965', 
'13712309', '13867942', '14200856', '14650048', '14772588', '22993122', 
'23069217', '23540277', '24822756', '24873271', '24917278', '25110508', 
'25359961', '25389951', '25880665', '25967898', '26257343', '26391890', 
'26592493', '26604855', '26608048', '26643049', '26647036', '26658878', 
'26661540', '26673376', '26707381', '26762335', '27064771', '27065978', 
'27118502', '27198535', '27199749', '27283136', '27285224', '27398948', 
'27514111', '27943892', '29301221') 
order by M003;
--46

insert into PP23.PP23_SCV_TASA_V02_T(MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082)
select MEV, M003, M0581, PRCA008, PRCA090, PRCA022, PRCA023, PRCA093, PRCA017, 
PRCA094, PRCA081, PRCA150, PRCA151, PRCA078, PRCA149, PRCA054, PRCA024, PRDA066, PRDA068, PRCA004, PRCA007, 
PRCA020, PRCA091, PRCA092, PRCA103, PRDA082 from PP23.PP23_W_TASA_2329_SCV_V02_T where M003 not in (select M003 from PP23.PP23_SCV_TASA_V02_T);
--46 cég áttöltése

commit;




ALTER TABLE PP23.CEGLISTA_VEGLEGES ADD CONSTRAINT M003_CEGLISTA_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.CEGLISTA_SCV_VEGLEGES ADD CONSTRAINT M003_CEGLISTA_SCV_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_W_TASA_2329_V02_T ADD CONSTRAINT M003_2329_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_W_TASA_2371_V02_T ADD CONSTRAINT M003_2371_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_KATA_V02_T ADD CONSTRAINT M003_23KATA_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_KIVA_V02_T ADD CONSTRAINT M003_23KIVA_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_W_TASA_2301_V02_T ADD CONSTRAINT M003_2301_V02_PK PRIMARY KEY (M003);
ALTER TABLE PP23.PP23_W_TASA_2308_V02_T ADD CONSTRAINT M003_2308_V02_PK PRIMARY KEY (M003);